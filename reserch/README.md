## Тестирование производительности Vertica и Clickhouse

---


В рамках исследования были рассмотрены хранилища:
- Vertica
- Clickhouse (выбрано нами как основное хранилище для хранения инфо о деятельности пользователей)

Для каждого хранилища в своей папке собран свой docker-compose для запуска кластера,
скрипты генерации данных и benchmark тестов
---
### Информация:
Для корректной проверки в хранилище добавлено 10 000 000 записей.

Для каждого хранилища написаны скрипты генерации фейковых данных и 
скрипты замеров времени на запромы к БД при различных профилях (с нагрузкой и без нагрузки на хранилище).
Запросы: 
 - Простой SELECT - 2 запроса
 - Простой агрегирующий COUNT - 2 запроса
 - Сложный агрегирующий с SUM, MAX, GROUP BY - 1 запрос


Каждый запрос отправлялся в хранилище по 10 раз, 
считалось среднее время для каждого запроса и общее время для 10 запросов одного типа.

--- 

### Результаты

#### Время вставки 10 000 000 записей (сек.):
 - Clickhouse 208.8 
 - Vertica 464.3

Разница: **122%**

#### Запросы без нагрузки (среднее время запроса в сек.):

| тип теста           | Clickhouse | Vertica | Разница  |
|---------------------|------------|---------|----------|
| unique_user_exact   | 0.088      | 0.244   | **177%** |
| unique_movies_exact | 0.081      | 0.240   | **196%** |
| unique_movies_count | 0.063      | 0.238   | **277%** |
| unique_users_count  | 0.059      | 0.243   | **311%** |
| user_stat           | 0.132      | 1.135   | **759%** |


#### Запросы c нагрузкой (среднее время запроса в сек.):

| тип теста           | Clickhouse | Vertica | Разница  |
|---------------------|------------|---------|----------|
| unique_user_exact   | 0.106      | 0.164   | **54%**  |
| unique_movies_exact | 0.096      | 0.155   | **61%**  |
| unique_movies_count | 0.111      | 0.160   | **44%**  |
| unique_users_count  | 0.121      | 0.175   | **44%**  |
| user_stat           | 0.3        | 0.741   | **147%** |


---
### Выводы

Из сравнительных таблиц видно, что Clickhouse имеет преимущество 
по времени в поиске данных, как под нагрузкой, так и без.

Также скорость вставки 10 000 000 записей оказалась быстрее у Clickhouse более чем в 2 раза.

Следовательно наш выбор пал на  Clickhouse.