# Проектная работа 8 и 9 спринтов
https://github.com/Nishela/UGC_service_team_2

## Основные сервисы 
#### UGC сервис(информация о состоянии просмотра фильма):
    Принимает запросы от клиентов и сохраняет данные в Kafka.
#### ETL сервис:
    Отправляет данные из Kafka в CLickhouse.
#### UGC Mongo сервис:
    Принимает запросы от клиентов и сохраняет данные в Mongo.
    Информация по лайкам, рецензиям и закладкам.


# Инструкция по использованию

---
##  8 спринт
### Запуск:
1. Создаем файл `.env` на примере `.env.example`
2. Выполняем сборку и запуск проекта:
```shell
$ make run
```

### Пример запроса 

Информация о прогрессе просмотра фильма для пользователя:
```shell
curl --location --request POST 'http://127.0.0.1:8000/ugc_service/v1/producer/send_event' \
--header 'Content-Type: application/json' \
--data-raw '{
  "event_name": "views",
  "user_id": "100",
  "data": {
    "movie_id": "123sf124",
    "value": "124251"
  }
}'
```


---
## Makefile функции: 

- собрать и сразу запустить проект
```shell
make run
```
- собрать и сразу запустить проект на машинах M1
```shell
make run_m1
```
- удалить все контейнеры
```shell
make delete
```
- просмотр логов UGC сервиса
```shell
make ugc_logs
```
- просмотр логов ETL сервиса
```shell
make elt_logs
```
---

## 9 Спринт

В рамках спринта были реализованы следующие задачи:
- Добавлен API сервис **ugc_mongo_service** для хранения лайков, закладок и рецензий.
- Реализован ELK.
- Добавлены проверки для github actions.
- Настроен CI/CD с отправкой уведомлений в телеграмм.
- Проведено исследование скорости работы хранилища MongoDB.

Для запуска сервиса **ugc_mongo_service** и поднятия кластера хранилища:
```shell
make run_and_config_mongo
```

---
### Схема TO BE: 
![img.png](schema_new.jpg)
